pico-8 cartridge // http://www.pico-8.com
version 41
__lua__

function _init()
  cls()

  palt(11, true) -- beige color as transparency is true
  palt(0, false) -- black color as transparency is false

	init_joka()
	init_zivuljke()
end

function _update()
	update_joka()
	update_camera()
end

function _draw()
	cls()
	map()
	draw_joka()
	draw_zivuljke()
	--debug
	--is_solid("full",joka,0,0,{},true)

	
end
-->8
--joka


function init_joka()
	joka={
		s=1,
		w=15,
		h=23,
		ox=0,
		oy=0,
		col= {
			w=10,--15
			h=10,--15
			ox=3,--0
			oy=13,--8
		},
		x=160,
		y=60,
		sx=false,
		sy=false
	}
end

function update_joka()
	local j=joka
	local dx,dy=0,0
 if btn(⬅️) then
  j.sx = true  -- flip sprite on x
  dx=-1
 end
 if btn(➡️) then
  j.sx = false
  dx+=1  -- dx=dx+1
 end
 if btn(⬆️) then
  j.sy = false
  dy=-1
 end
 if btn(⬇️) then
  //j.sy = true  -- flip sprite on y
  dy+=1  -- dy=dy+1
 end
 
 -- there's no map-tile with
 -- flag "7" on the players'
 -- position + dx ? then move:
 if not is_solid("full",j,dx,0,7) then
  j.x+=dx
 end
 -- there's no map-tile with
 -- flag "7" on the players'
 -- position + dy ? then move:
 if not is_solid("full",j,0,dy,7) then
  j.y+=dy
 end
	
end

function draw_joka()
	local j=joka
	--spr(s.id,joka.x,joka.y,s.w,s.h)
	--sspr(8,0,16,24,joka.x,joka.y,16,24)
	spr(j.s, j.x, j.y,flr((j.w+j.ox)/8)+1,flr((j.h+j.oy)/8)+1,j.sx,j.sy)
end
-->8
-- camera

function update_camera()
	camx=joka.x-64
	camy=joka.y-64
	camera(camx,camy)
end
-->8
-- collision

function is_solid(opt,obj,ox,oy,flags,debug)
 local collist={}
 local f={}
 f.x=obj.x
 f.y=obj.y
 if obj.col != nil then
 	f.w=obj.col.w
 	f.h=obj.col.h
 	f.ox=obj.col.ox
 	f.oy=obj.col.oy
 else
 	f.w=obj.w
 	f.h=obj.h
 	f.ox=obj.ox
 	f.oy=obj.oy
 end
 ox = ox or 0
 oy = oy or 0
 flags=flags or {0}
 if(type(flags)!="table")flags={flags}
 local ix=f.x+f.ox+ox
 local iy=f.y+f.oy+oy
 for x=ix,ix+f.w+7,8 do
  for y=iy,iy+f.h+7,8 do
   if opt==nil
   or opt=="full"
   or opt=="left" and x==ix
   or opt=="right" and x>=ix+f.w
   or opt=="up" and y==iy
   or opt=="down" and y>=iy+f.h
   or opt=="rdown" and y>=iy+f.h and x>=ix+f.w
   or opt=="ldown" and x==ix and y>=iy+f.h
   or opt=="rup" and y==iy and x>=ix+f.w
   or opt=="lup" and y==iy and x==ix
   then
    add(collist, {x=min(x,ix+f.w), y=min(y,iy+f.h)})
   end
  end
 end
 if(debug)print(#collist)
 for c in all(collist) do
  if(debug)pset(c.x,c.y,8)
  for v in all(flags) do
   if(fget(mget(c.x/8,c.y/8),v))return true
  end
 end
 return false
end
-->8
--zivuljke

function init_dog(s,x,y)
 return {
		s=s,
		w=15,
		h=15,
		ox=0,
		oy=0,
		x=x,
		y=y,
		sx=false,
		sy=false
	}
end


function init_zivuljke()
	julija=init_dog(64,100,60)
	dora=init_dog(68,145,105)
	belka=init_dog(66,250,155)
	prca=init_dog(72,162,15)
end

function draw_zivuljke()
	local j=julija
	spr(j.s, j.x, j.y,flr((j.w+j.ox)/8)+1,flr((j.h+j.oy)/8)+1,j.sx,j.sy)
	local j=dora
	spr(j.s, j.x, j.y,flr((j.w+j.ox)/8)+1,flr((j.h+j.oy)/8)+1,j.sx,j.sy)
	local j=belka
	spr(j.s, j.x, j.y,flr((j.w+j.ox)/8)+1,flr((j.h+j.oy)/8)+1,j.sx,j.sy)
	local j=prca
	spr(j.s, j.x, j.y,flr((j.w+j.ox)/8)+1,flr((j.h+j.oy)/8)+1,j.sx,j.sy)

end
__gfx__
00000000bbbb0000000bbbbb000000004447c000555555554444444477777777dddddddddd111111111111dddddddddddd111111111111dddddddddd11111111
00000000bbb044444440bbbb00000000444c7000555555554444444477777777dddddddddd111111111111dddddddddddd111111111111dddddddddd11111111
00700700bb04444444440bbb00000000444cc00055555555444444447777777711111111dd111111111111dddd111111dd111111111111dd111111dd11111111
00077000b0444444444440bb000000004447c00055555555444444447777777711111111dd111111111111dddd111111dd111111111111dd111111dd11111111
00077000044444444444440b00000000444c700055555555444444447777777711111111dd111111111111dddd111111dd111111111111dd111111dd11111111
00700700044444444444444000000000444cc00055555555444444447777777711111111dd111111111111dddd111111dd111111111111dd111111dd11111111
000000000444444444444440000000004447c00055555555444444447777777711111111dd111111111111dddd111111dddddddddddddddd111111dddddddddd
00000000044444444444444000000000444c700055555555444444447777777711111111dd111111111111dddd111111dddddddddddddddd111111dddddddddd
00000000044444f0fff0444000000000000000000000000000000000000000001111111111111111ffffffff9191919144444444666666664444444466666666
0000000004444f0fff0ff44000000000000000000000000000000000000000001111111111ffff11ffffffff191919196666666466666666444444446608a666
0000000004f44f0fff0ff40b0000000000000000000000000000000000000000111111111ffffff1ffffffff91919191666666646666666644444444660ce666
0000000004f44f0fff0ff0bb000000000000000000000000000000000000000011111111ffffffffffffffff1919191966666664666666664444444466093666
0000000004f44efffffef0bb000000000000000000000000000000000000000011111111ffffffffffffffff9191919166666664666666664444444466066666
0000000004444ffffffff0bb000000000000000000000000000000000000000011111111ffffffff1ffffff11919191966666664666666664444444460006666
0000000004444ff88ffff0bb000000000000000000000000000000000000000011111111ffffffff11ffff119191919166666664666666664444444466666666
000000000444000ff00040bb000000000000000000000000000000000000000011111111ffffffff111111111919191966666664666666664446644466666666
0000000004409999999040bb0000000000000000000000000000000000000000444444444444444440000000000000044444444446aaaa666666666455555555
000000000409909999900bbb0000000000000000000000000000000000000000400000000000000440000000000000044666666646aaaa666666666466666666
00000000b0990999999090bb00000000000000000000000000000000000000004000000000000004400000000000000446eee66646aaaa666655556456555565
00000000b0ff09999990f0bb00000000000000000000000000000000000000004000005555000004400000000000000446eee66646a00a666656756466666666
00000000b0ff0aaaaaa0f0bb0000000000000000000000000000000000000000400000000000000440000000000000044633366646aaaa666657056456555565
00000000bb00000000000bbb00000000000000000000000000000000000000004000000000000004400000000000000446333666466666666655556466666666
00000000bbb0a0bbb0a0bbbb00000000000000000000000000000000000000004000000000000004400000000000000446666666466666666666666456555565
00000000bbb0d0bbb0d0bbbb00000000000000000000000000000000000000004000000000000004444444444444444446666666444444444444444466666666
00000000000000000000000000000000000000000000000000000000000000005566665555666655000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000005677776556777765000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000677cc77667749776000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000067cccc7667944476000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000067cccc7667494976000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000677cc77667744776000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000005677776556777765000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000005566665555666655000000000000000000000000000000000000000000000000
bbb0000bbbbb0000bbb0000bbbbb0000bbb0000bbbbb0000bbb0000bbbbb0000bbb0000bbbbb0000bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
bbb0999000009940bbb0775000006600bbb0555000005550bbb0555000005550bbb0775000006600b0bbbbbbbbb0bbbbb0bbbbbbbbb0bbbbb0bbbbbbbbb0bbbb
bbbb00999449900bbbbb00557666600bbbbb00555555500bbbbb00555555500bbbbb00557666600b050bbbbbbb050bbb070bbbbbbb090bbb070bbbbbbb070bbb
bbbbb099994990bbbbbbb077776660bbbbbbb055555550bbbbbbb055555550bbbbbbb077776660bb0550000000550bbb0770000000990bbb0770000000770bbb
bbbbb090999090bbbbbbb070776060bbbbbbb050555050bbbbbbb050555050bbbbbbb070776060bb0555557555550bbb0575557555590bbb0777777777770bbb
bbbbb099909990bbbbbbb0977076a0bbbbbbb055505550bbbbbbb055505550bbbbbbb067707660bb0755557777550bbb0755557799550bbb0777777777770bbb
bbbbb099909990bbbbbbb079707970bbbbbbb055505550bbbbbbb055505550bbbbbbb076007670bb0775055707550bbb0995055709550bbb0777077707770bbb
bbbbb099090990bbbbbbb0a70707a0bbbbbbb055050550bbbbbbb055050550bbbbbbb067070760bb0755055505570bbb0755055505570bbb0777077707770bbb
bbbbbb0999990bbbbbbbbb0777770bbbbbbbbb0555550bbbbbbbbb0555550bbbbbbbbb0777770bbb0555550555770bbb0555550555970bbb0777770777770bbb
b0bbb049979990bbb0bbb055777750bbb0bbb055575550bbb0bbb065575550bbb0bbb055777750bbb055555557770b0bb055555559970b0bb077777777770b0b
040b0499977990bb060b0577777770bb050b0555577550bb050b0555777550bb060b0577777770bbbb0055555500b050bb0055555500b050bb0077777700b070
09404994947490bb05606775757570bb05505550507050bb06506550707050bb05606775757570bbbb0555575550b070bb0995575550b070bb0777777770b070
b0949994949490bbb0567775757570bbb0555550505050bbb0555550705050bbb0567775757570bbb05755575555050bb05795575995090bb05777777777070b
bb009949949940bbbb007757757750bbbb005505505500bbbb005505505500bbbb007757757750bbb0775055705550bbb0775055709550bbb0777077707770bb
bbbb0949909940bbbbbb0757707750bbbbbb0505505500bbbbbb0505505500bbbbbb0757707750bbb055505550550bbbb055505550550bbbb077707770770bbb
bbbbb0000b0000bbbbbbb0000b0000bbbbbbb0000b0000bbbbbbb0000b0000bbbbbbb0000b0000bbbb0000000000bbbbbb0000000000bbbbbb0000000000bbbb
bbb0000bbbbb00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbb09990000099400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbb00999449900b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbb099994990bb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbb090999090bb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbb099909990bb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbb099909990bb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbb099090990bb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbb0999990bbb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbb049979990bb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbb0499977990bb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbb04994947490bb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bb049994949490bb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
b0499949949940bb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
04900949909940bb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
b00bb0000b0000bb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb60606060607060606060606060606060700000000000000000000000000000000000000000000000
b0bbbbbbbbb0bbbbb0bbbbbbbbb0bbbbb0bbbbbbbbb0bbbb00000000000000000000000000000000000000000000000000000000000000000000000000000000
070bbbbbbb070bbb050bbbbbbb050bbb050bbbbbbb050bbb70707070707070707070707070707070700000000000000000000000000000000000000000000000
0770000000770bbb0350000000530bbb0350000000530bbb00000000000000000000000000000000000000000000000000000000000000000000000000000000
0777777777770bbb0d355555553d0bbb0d355555553d0bbb00000000000000000000000000000000000000000000000000000000000000000000000000000000
0777777777770bbb03d3555553d30bbb03d3555553d30bbb00000000000000000000000000000000000000000000000000000000000000000000000000000000
0777077707770bbb0d359555953d0bbb0d350555053d0bbb00000000000000000000000000000000000000000000000000000000000000000000000000000000
0777077707770bbb05dd95559dd50bbb05dd05550dd50bbb00000000000000000000000000000000000000000000000000000000000000000000000000000000
0777770777770bbb05d5550555d50bbb05d5550555d50bbb00000000000000000000000000000000000000000000000000000000000000000000000000000000
0777777777770b0bb05d55555d530b0bb05d55555d530b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000
0777777777770070bb0055555500b0d0bb0055555500b0d000000000000000000000000000000000000000000000000000000000000000000000000000000000
0777777777770070bb05d535d5d0b050bb05d535d5d0b05000000000000000000000000000000000000000000000000000000000000000000000000000000000
077777777777070bb05353d3535d030bb05353d3535d030b00000000000000000000000000000000000000000000000000000000000000000000000000000000
07777077707770bbb0353055303550bbb0353055303550bb00000000000000000000000000000000000000000000000000000000000000000000000000000000
0077707770770bbbb05d505d50d30bbbb05d505d50d30bbb00000000000000000000000000000000000000000000000000000000000000000000000000000000
b00000000000bbbbbb0000000000bbbbbb0000000000bbbb00000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000080000080000000000000000000000000000000000000000080800080000000000000000000000000808080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0707070707070707070707070707070707070707070707070707070707070707000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
070606060606060606060606060606060606070b08080808080e061f1d1d1d07000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
070606060606060606060606060606060606070919181b1b1b0a061d1d1d1d07000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
07060606060606060606060606060606060607091a181b1b1b0a062829060604000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
070606060606060606060606060606060606070919181b1b1b0a062a2b060604000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
07060606060606060606060606060606060607091a181b1b1b0a060606060607000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
070606060606060606060606060606060606070c0f0f0f0f0f0d060606060607000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0706060606060606060606060606060606060706060606060606060606060607000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0706060606060606060606060606060606060706060606060606061e061e0607000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0706060606060606060606060606060606060706060606062c1c1d1d1d1d1d07000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0706060606060606060606060606060606060706060606062d2e1d1d1d1d1d07000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070707070707070707070707050507070707070705050707070707070707000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0705050505050505050505070505050505380539050505050505050505050507000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0705050505050505050505070505050505050505050505050505050505050507000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0705050505050505050505050505050505050505050505050505050505050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0705050505050505050505050505050505050505050505050505050505050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
070505050505050505050507050505050505051d1d1d1d1d1d1d050505050507000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
070505050505050505050507050505050505051d1d1d1d1d1d1d2f2f2f050507000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070707070707070707070707050507070707070707070707070707070707070707101007070707000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0706060606060606060606060606060606060606060606060606060606070606060606060606060607000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0706060606060606060606060606060606060606060606060606060606060606060606060606060607000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0706060606060606060606060606060606060606060606060606060606060606060606060606060607000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0706060606060606060606060606060606060606060606060606060606070606060606060606060607000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0706060606060606060606060606060606060606060606060606060606070606060606060606060607000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0706060606060606060606060606060606060606060606060606060606070606060606060606060607000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0706060606060606060606060606060606060606060606060606060606070606060606060606060607000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0706060606060606060606060606060606060606060606060606060606070606060606060606060607000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0706060606060606060606060606060606060606060606060606060606070606060606060606060607000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0706060606060606060606060606060606060606060606060606060606070606060606060606060607000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0706060606060606060606060606060606060606060606060606060606070606060606060606060607000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0706060606060606060606060606060606060606060606060606060606070606060606060606060607000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0706060606060606060606060606060606060606060606060606060606070606060606060606060607000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
